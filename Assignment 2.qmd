---
title: "Hvilke sammenhenger har vi mellom inntekt, kjønn og BMI?"
format: revealjs
editor: visual
lang: no_nb
csl: hvl_apa7_stil_bokmal_v1.csl
bibliography: Data Science.bib
---

```{r}
library(modelr)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(vtable)
library(flextable)
library(scales)
library(tinytex)
```

```{r}
Sys.setlocale("LC_ALL", "Norwegian")
```

```{r}
heights <- modelr::heights
```

## Problemstilling

-   Hva sier data hentet fra datasettet "modelr::heights" om sammenhengen mellom inntekt, kjønn og BMI?

-   Hvordan kan mønstre i data underbygge diskusjonen hos @judge2004 om fysisk fremtoning og suksess i arbeidslivet?

## Hva er BMI?

BMI er en skala som måler forholdet mellom en persons høyde og vekt

Skalaen er en indikator på hvor sunn personen er

Tar ikke høyde for fordeling mellom fett og muskler

## Datagrunnlag

```{r}
heights_bmi <- heights %>%
  mutate(
    bmi = (weight / (height^2)) * 703,
    sex = fct_recode(sex, Kvinner = "female", Menn = "male")
  ) %>%
  filter(!is.na(income))
```

-   I modellen er høyde og vekt oppgitt i henholvdsvis tommar og pund. For å finne frem til objektenes MBI benytes følgende formel: (vekt/ høyde\^2) \*703.
-   Vi fjernar observasjonar utan registrert inntekt for å fokusere på relasjonen mellom inntekt, kjønn og BMI.

## Gjenomsnittelig fordeling

```{r}
basic_stats <- heights_bmi %>%
  group_by(sex) %>%
  summarise(
    N = n(),
    `Gj. inntekt` = mean(income, na.rm = TRUE),
    `Median inntekt` = median(income, na.rm = TRUE),
    `Gj. BMI` = mean(bmi, na.rm = TRUE),
    `Median BMI` = median(bmi, na.rm = TRUE)
  )

basic_stats %>%
  mutate(
    `Gj. inntekt` = dollar(`Gj. inntekt`, prefix = "", suffix = " USD"),
    `Median inntekt` = dollar(`Median inntekt`, prefix = "", suffix = " USD"),
    `Gj. BMI` = number(`Gj. BMI`, accuracy = 0.1),
    `Median BMI` = number(`Median BMI`, accuracy = 0.1)
  ) %>%
  knitr::kable(col.names
                 = c("Kjønn", "N", "Gj. inntekt", "Median inntekt", "Gj. BMI", "Median BMI"))
```

-   Menn tjener i gjennomsnitt mer enn kvinner i dette datasettet.
-   Kjønnsforskjellen i BMI er mindre markant, men menn har noe høyere median.

## Fordeling av BMI

```{r}
heights_bmi %>%
  ggplot(aes(x = bmi, fill = sex)) +
  geom_histogram(alpha = 0.7, position = "identity", bins = 30) +
  scale_fill_manual(values = c("#88C0D0", "#BF616A")) +
  labs(
    title = "Fordeling av BMI etter kjønn",
    x = "BMI",
    y = "Antal"
  ) +
  theme_minimal(base_size = 16)

```

-   Begge kjønn viser en relativt normalfordelt BMI rundt midten av 20-tallet.
-   Kvinner har en litt mer sammenklemt fordeling, mens menn har flere observasjoner med høyere BMI.

## Deskriptiv statistikk

```{r}
bmi_tabell <- data.frame(
  Kategori = c("Undervekt", "Normal vekt", "Overvekt", "Fedme"),
  Fra = c(0, 18.5, 25, 30),
  Til = c(18.5, 25, 30, Inf)
)

# Vis tabellen
bmi_tabell
```

Verdens helse organisasjon (who) har grupert BMI skalaen i 4 hovedgrupper.
@canadian2003

## Fordeling etter BMI kategorier

```{r}
heights_bmi %>%
  mutate(bmi_group = cut(bmi, breaks = c(0, 18.5, 25, 30, 100),
                         labels = c("Undervekt", "Normal", "Overvekt", "Fedme"))) %>%
  filter(!is.na(income), !is.na(bmi_group), !is.na(sex)) %>%
  group_by(sex, bmi_group) %>%
  summarise(mean_income = mean(income), .groups = "drop") %>%
  ggplot(aes(x = bmi_group, y = mean_income, fill = sex)) +
  geom_col(position = "dodge") +
  scale_y_continuous(labels = label_comma()) +
  labs(
    x = "BMI-kategori",
    y = "Gjennomsnittlig inntekt",
    fill = "Kjønn",
    title = "Gjennomsnittlig inntekt etter kjønn og BMI-kategori"
  ) +
  theme(
    axis.text = element_text(size = 15),
    axis.title = element_text(size = 15),
    plot.title = element_text(size = 16, face = "bold")
  )

```

## Helse sin påvirkning på atraksjon

@rhodes2007 Sier at studier indikerer at helse er med å påvirke hvor atraktiv en person fremstår

@kanazawa2004 Sier at studier gir emperi for at attraktive personer er smartere enn uattraktive personer

BMI er en indikasjon på helse

## Glorie-effekten

Menn som faller innenfor overvekt, og kvinner innenfor normalvekt tjener mest etter dataene.

En forklaring på dette kan være den såkalte Glorie- effekten

BMI tar bare høyde for total vekt, og ikke fordeling av muskler og fett

BMI er bare en av mange variabler som utgjør atraksjon

## Korrelasjon mellom inntekt og BMI

```{r}
cor_tabel <- heights_bmi %>%
  summarise(
    `Korrelasjon totalt` = cor(income, bmi, use = "complete.obs")
  ) %>%
  mutate(Kategori = "Totalt") %>%
  relocate(Kategori) %>%
  bind_rows(
    heights_bmi %>%
      group_by(sex) %>%
      summarise(`Korrelasjon totalt` = cor(income, bmi, use = "complete.obs")) %>%
      rename(Kategori = sex)
  )

cor_tabel %>%
  mutate(`Korrelasjon totalt` = number(`Korrelasjon totalt`, accuracy = 0.01)) %>%
  knitr::kable(col.names = c("Kategori", "Korrelasjon (inntekt vs BMI)"))
```

-   Korrelasjonen mellom inntekt og BMI er svak negativ totalt, og forskjellen mellom kjønn er små.
-   Dette tyder på at kjønnsforskjellene i inntekt hovedsaklig kommer frå andre forhold enn BMI.

## Avgrensingar og videre arbeid

-   Data er observasjonelle og fanger ikke nødvendigvis opp årsakssammenhenger.
-   Inntekt er rapportert i USD og kan være påvirket av geografi og sektor.

## Konklusjon

1.  Kjønn er en sterkere indikator for inntekt enn BMI i dette utvalget.

2.  BMI for kvinner

3.  Glorie effekten støtter judge sin påstand om at fysisk fremtoning påvirker suksess i arbeidslivet (@judge2004).
    Vi vil påpeke at BMI bare en en av mange variabler her og det er begrenset hvor mye av effekten som kan tilegnes.
